!function(){"use strict";const t="https://determined-painted-hawthorn.glitch.me/api",e=async e=>{const n=await fetch(t+e);return await n.json()},n=()=>JSON.parse(localStorage.getItem("cart")),o=(t,e)=>{const n=new URL(window.location.href);return e?[n.searchParams.get(t),n.searchParams.get(e)]:n.searchParams.get(t)},c=(t,e)=>Math.round(t*(100-e)/100),r=t=>{if(String(t).length>=4){const e=t%1e3,n=Math.trunc(t/1e3);return String(n)+" "+(String(e).padStart(3,"0")||"000")}return t},a=(t,e)=>{const n=document.createElement(t);return n.className=e,n},i=(t,e,n)=>{const o=a(t,e);return o.textContent=`-${n}%`,o},s=t=>{const e=a("li","sublist__item"),n=a("a","sublist__link");return n.textContent=t,e.append(n),n.href=`catalog.html?category=${t}`,e},d=(t,e)=>{const n=t.map((t=>(({id:t,price:e,title:n,image:o,discount:r,category:s})=>{const d=a("li","benefit__item card");d.dataset.name=t;const l=a("a","benefit__link"),p=`card.html?category=${s}&id=${t}`;l.href=p;const _=a("div","card-img__wrapper"),u=a("img","card__img");u.loading="lazy",u.width="420",u.height="295",u.src=`https://determined-painted-hawthorn.glitch.me/${o}`,u.addEventListener("error",(()=>{u.src="assets/images/no-photo.jpg"})),_.append(u);const g=a("div","card__price"),m=a("span","card__sale-price");if(m.textContent=`${e} ₽`,r){const t=i("span","card__sale",r);_.append(t);const n=a("span","card__start-price");n.textContent=`${e} ₽`,m.textContent=c(e,r)+" ₽",g.append(m,n)}else g.append(m);const h=a("p","card__title");return h.textContent=n,l.append(_,g,h),d.append(l),d})(t))),o=a("ul","benefit__list");return o.append(...n),o},l=t=>{const e=a("h1","good-card__title");e.textContent=t.title;const n=(({price:t,discount:e})=>{const n=a("div","good-card__price good-price");n.insertAdjacentHTML("afterbegin",'     \n        <p class="good-price__credit">В кредит от 5600 ₽ </p>\n        <button class="button good-price__btn">Добавить в корзину</button>\n        <button class="good-price__favorite">\n          <svg width="33" height="33" viewBox="0 0 33 33" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n            <g clip-path="url(#clip0_901_1437)">\n              <path d="M22.6875 4.125C20.295 4.125 17.9987 5.23875 16.5 6.99875C15.0012 5.23875 12.705 4.125 10.3125 4.125C6.0775 4.125 2.75 7.4525 2.75 11.6875C2.75 16.885 7.425 21.12 14.5062 27.555L16.5 29.3563L18.4937 27.5413C25.575 21.12 30.25 16.885 30.25 11.6875C30.25 7.4525 26.9225 4.125 22.6875 4.125ZM16.6375 25.5062L16.5 25.6437L16.3625 25.5062C9.8175 19.58 5.5 15.6613 5.5 11.6875C5.5 8.9375 7.5625 6.875 10.3125 6.875C12.43 6.875 14.4925 8.23625 15.2212 10.12H17.7925C18.5075 8.23625 20.57 6.875 22.6875 6.875C25.4375 6.875 27.5 8.9375 27.5 11.6875C27.5 15.6613 23.1825 19.58 16.6375 25.5062Z" fill="currentColor"/>\n            </g>\n            <defs>\n              <clipPath id="clip0_901_1437">\n              <rect width="33" height="33" fill="white"/>\n              </clipPath>\n            </defs>\n          </svg>\n        </button>\n        <div class="good-price__outer-box">\n          <div class="good-price__inner-box">\n            <p class="good-price__subtitle">\n              Доставка\n            </p>\n            <p class="good-price__subtitle-detail">\n              1-3 января\n            </p>\n          </div>\n          <div class="good-price__inner-box">\n            <p class="good-price__subtitle">\n              Продавец\n            </p>\n            <p class="good-price__subtitle-detail">\n              ShopOnline\n            </p>          \n          </div>\n          </div>\n          <button class="good-price__bell">Узнать о снижении цены</button>\n        </div>\n      ');const o=c(t,e),i=r(o),s=r(t),d=a("span","good-price__title");if(d.textContent=`${i} ₽`,n.prepend(d),e){const t=a("span","good-price__old-title");t.textContent=`${s} ₽`,d.after(t)}return n})(t),o=(({discount:t,image:e})=>{const n=a("div","good-card__img-box"),o=a("img","good-card__img");if(o.src=`https://determined-painted-hawthorn.glitch.me/${e}`,o.addEventListener("error",(()=>{o.src="assets/images/no-photo.jpg"})),n.append(o),t){const e=i("div","sale good-card__sale",t);n.append(e)}return n})(t),s=a("div","good-card__wrap");s.append(o,n);const{title:d,content:l}=(({description:t})=>{const e=a("h2","good-card__subtitle");e.textContent="Описание:";const n=a("p","good-card__description");return n.textContent=t,{title:e,content:n}})(t);return{titlePage:e,wrapCard:s,titleDescript:d,content:l}},p=async()=>{const[t,n]=o("category","id");(t=>{const e=document.querySelector(".nav-breadcrumb").lastElementChild.querySelector("a");e.textContent=t,e.href=`catalog.html?category=${t}`})(t);const c=`/goods/${n}`,r=await e(c),{titlePage:i,wrapCard:s,titleDescript:p,content:_}=l(r),u=`/goods/category/${r.category}`,g=await e(u),{titleRecommend:m,wrapRecommend:h}=(t=>{const e=a("p","recommend__title");e.textContent="Рекомендуем также";const n=a("div","recommend__wrap"),o=d(t);return n.append(o),{titleRecommend:e,wrapRecommend:n}})(g);document.querySelector(".good-card").append(i,s,p,_);return document.querySelector(".recommend").append(m,h),r},_=t=>{const e=(n()||[]).reduce(((t,e)=>t+Number(e.count)),0)||"",o=document.querySelector(".btn-cart__count");e?(o.textContent=e,o.style.backgroundColor="#ffffff"):(o.textContent=e,o.style.backgroundColor="transparent"),t&&(document.querySelector(".cart__count").textContent=e,document.querySelector(".span__count").textContent=e)},u=(document.querySelector(".cart-list"),(t,e,n)=>{if(-1===n){const n={id:e.id,count:1,price:e.price,discount:e.discount};t.push(n)}else t[n].count++;(t=>{localStorage.setItem("cart",JSON.stringify(t))})(t)}),g=async()=>{const t=n()||[],c=o("id"),r=`/goods/${c}`,a=await e(r),i=((t,e)=>t.findIndex((t=>t.id===e)))(t,c);u(t,a,i),_()};(async()=>{(()=>{const t=document.querySelectorAll(".nav__item_catalog .nav__title"),e=document.querySelectorAll(".nav__item_buyer .nav__title"),n=document.querySelectorAll(".sublist_catalog"),o=document.querySelectorAll(".sublist_buyer");t.forEach(((t,e)=>{t.addEventListener("click",(()=>{n[e].classList.toggle("sublist_show")}))})),e.forEach(((t,e)=>{t.addEventListener("click",(()=>{o[e].classList.toggle("sublist_show")}))}))})(),(()=>{const t=document.querySelector(".menu"),e=t.querySelector(".menu__img");t.addEventListener("click",(()=>{document.querySelector(".header-nav").classList.toggle("header-nav_active"),e.classList.toggle("menu__img-active")}))})(),(async()=>{const t=await e("/category"),n=document.querySelector(".header .sublist_catalog"),o=document.querySelector(".footer .sublist_catalog"),c=t.map((t=>s(t))),r=t.map((t=>s(t)));n.append(...c),o.append(...r)})(),await p(),document.querySelector(".good-price__btn").addEventListener("click",g),_()})()}();
!function(){"use strict";const t=()=>(JSON.parse(localStorage.getItem("cart"))||[]).reduce(((t,e)=>t+Number(e.count)),0)||"",e=(t,e)=>{const n=document.createElement(t);return n.className=e,n},n=(t,n,a)=>{const s=e(t,n);return s.textContent=`-${a}%`,s},a=t=>{const n=e("li","sublist__item"),a=e("a","sublist__link");return a.textContent=t,n.append(a),a.href=`catalog.html?category=${t}`,n},s=({id:t,price:a,title:s,image:o,discount:c,category:i})=>{const r=e("li","benefit__item card");r.dataset.name=t;const l=e("a","benefit__link"),d=`card.html?category=${i}&id=${t}`;l.href=d;const _=e("div","card-img__wrapper"),u=e("img","card__img");u.loading="lazy",u.width="420",u.height="295",u.src=`https://determined-painted-hawthorn.glitch.me/${o}`,u.addEventListener("error",(()=>{u.src="assets/images/no-photo.jpg"})),_.append(u);const m=e("div","card__price"),p=e("span","card__sale-price");if(p.textContent=`${a} ₽`,c){const t=n("span","card__sale",c);_.append(t);const s=e("span","card__start-price");s.textContent=`${a} ₽`,p.textContent=((t,e)=>Math.round(t*(100-e)/100))(a,c)+" ₽",m.append(p,s)}else m.append(p);const h=e("p","card__title");return h.textContent=s,l.append(_,m,h),r.append(l),r},o=(t,n)=>{const a=t.map((t=>s(t))),o=e("ul","benefit__list");return o.append(...a),o},c=t=>{const e=60*(new Date).getTimezoneOffset()*1e3,n=document.querySelector(".digital__day"),a=document.querySelector(".digital__hour"),s=document.querySelector(".digital__minute"),o=document.querySelector(".digital__second"),c=document.querySelector(".alpha__day"),i=document.querySelector(".alpha__hour"),r=document.querySelector(".alpha__minute"),l=document.querySelector(".alpha__second"),d=setInterval((()=>{const _=Date.now()+e,u=(t-_)/1e3,m=(t=>({seconds:Math.trunc(t%60),minutes:Math.trunc(t/60%60),hours:Math.trunc(t/60/60%24),days:Math.trunc(t/60/60/24)}))(u),{seconds:p,minutes:h,hours:g,days:y}=m;c.textContent=(t=>t%10==1&&11!==t?"день":t%10!=2&&t%10!=3&&t%10!=4||!(t<=5||t>=20)?"дней":"дня")(y),i.textContent=(t=>1===t||21===t?"час":t>=5&&t<=20||t%10==0?"часов":"часа")(g),r.textContent=(t=>t%10==1&&11!==t?"минута":t%10!=2&&t%10!=3&&t%10!=4||!(t<=5||t>=20)?"минут":"минуты")(h),l.textContent=(t=>t%10==1&&11!==t?"секунда":t%10!=2&&t%10!=3&&t%10!=4||!(t<=5||t>=20)?"секунд":"секунды")(p),n.textContent=String(y).padStart(2,"0"),a.textContent=String(g).padStart(2,"0"),s.textContent=String(h).padStart(2,"0"),o.textContent=String(p).padStart(2,"0"),(t=>{const e=document.querySelector(".time__show_seconds"),n=document.querySelector(".time__show_days");t<=86400?(n.classList.add("display_invisible"),e.classList.remove("display_invisible")):(n.classList.remove("display_invisible"),e.classList.add("display_invisible"))})(u),((t,e)=>{if(t<=0){const t=document.querySelector(".banner__time");clearInterval(e),t.classList.add("display_invisible")}})(u,d)}),1e3)},i="https://determined-painted-hawthorn.glitch.me/api",r=async t=>{const e=await fetch(i+t);return await e.json()},l=async()=>{const t=((t,e)=>{const n=new URL(window.location.href);return e?[n.searchParams.get(t),n.searchParams.get(e)]:n.searchParams.get(t)})("category"),n=`/goods/category/${t}`,a=await r(n),s=e("h1","catalog__title");s.textContent=t;const c=o(a),i=document.querySelector(".catalog__container");i.innerHTML="",i.append(s,c)},d=document.querySelectorAll(".sublist_catalog");(()=>{const n=document.querySelector("[data-timer-deadline]");if(n){(t=>{t.insertAdjacentHTML("afterbegin",' <p class="time__title">\n      До конца акции:\n    </p>\n    <div class="time__duration">\n      <div class="time__show time__show_days">\n        <p class="time__digital digital__day"></p>\n      <p class="time__alpha alpha__day"></p>\n      </div>\n      <div class="time__show time__show_hours">\n        <p class="time__digital digital__hour"></p>\n        <p class="time__alpha alpha__hour"></p>\n      </div>\n      <div class="time__show time__show_minutes">\n        <p class="time__digital digital__minute"></p>\n        <p class="time__alpha alpha__minute"></p>\n      </div>\n      <div class="time__show time__show_seconds">\n        <p class="time__digital digital__second"></p><p class="time__alpha alpha__second"></p>\n      </div>                        \n    </div> ')})(n);const t=(t=>new Date(t.dataset.timerDeadline).getTime())(n);c(t)}setTimeout((()=>{document.querySelector(".header-nav").classList.remove("header-nav_hidden")}),500),(()=>{const t=document.querySelectorAll(".nav__item_catalog .nav__title"),e=document.querySelectorAll(".nav__item_buyer .nav__title"),n=document.querySelectorAll(".sublist_catalog"),a=document.querySelectorAll(".sublist_buyer");t.forEach(((t,e)=>{t.addEventListener("click",(()=>{n[e].classList.toggle("sublist_show")}))})),e.forEach(((t,e)=>{t.addEventListener("click",(()=>{a[e].classList.toggle("sublist_show")}))}))})(),(()=>{const t=document.querySelector(".menu"),e=t.querySelector(".menu__img");t.addEventListener("click",(()=>{document.querySelector(".header-nav").classList.toggle("header-nav_active"),e.classList.toggle("menu__img-active")}))})(),(async()=>{const t=await r("/category"),e=document.querySelector(".header .sublist_catalog"),n=document.querySelector(".footer .sublist_catalog"),s=t.map((t=>a(t))),o=t.map((t=>a(t)));e.append(...s),n.append(...o)})(),(e=>{const n=t(),a=document.querySelector(".btn-cart__count");n?(a.textContent=n,a.style.backgroundColor="#ffffff"):(a.textContent=n,a.style.backgroundColor="transparent"),e&&(document.querySelector(".cart__count").textContent=n,document.querySelector(".span__count").textContent=n)})(),d.forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault();const e=t.target;if(e.closest(".sublist__link")){const t=e.textContent;location.href=`catalog.html?category=${t}`,l()}}))})),(async()=>{const t=(await r("/goods/")).filter((t=>t.discount)),n=e("h1","catalog__title");n.textContent="Это выгодно!";const a=o(t),s=document.querySelector(".benefit__container");s.innerHTML="",s.append(n,a)})()})()}();
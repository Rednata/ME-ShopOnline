!function(){"use strict";const t="https://determined-painted-hawthorn.glitch.me/api",e=async e=>{const n=await fetch(t+e);return await n.json()},n=()=>(JSON.parse(localStorage.getItem("cart"))||[]).reduce(((t,e)=>t+Number(e.count)),0)||"",a=(t,e)=>{const n=document.createElement(t);return n.className=e,n},c=(t,e,n)=>{const c=a(t,e);return c.textContent=`-${n}%`,c},o=t=>{const e=a("li","sublist__item"),n=a("a","sublist__link");return n.textContent=t,e.append(n),n.href=`catalog.html?category=${t}`,e},r=({id:t,price:e,title:n,image:o,discount:r,category:s})=>{const l=a("li","benefit__item card");l.dataset.name=t;const i=a("a","benefit__link"),d=`card.html?category=${s}&id=${t}`;i.href=d;const u=a("div","card-img__wrapper"),_=a("img","card__img");_.loading="lazy",_.width="420",_.height="295",_.src=`https://determined-painted-hawthorn.glitch.me/${o}`,_.addEventListener("error",(()=>{_.src="assets/images/no-photo.jpg"})),u.append(_);const m=a("div","card__price"),p=a("span","card__sale-price");if(p.textContent=`${e} ₽`,r){const t=c("span","card__sale",r);u.append(t);const n=a("span","card__start-price");n.textContent=`${e} ₽`,p.textContent=((t,e)=>Math.round(t*(100-e)/100))(e,r)+" ₽",m.append(p,n)}else m.append(p);const g=a("p","card__title");return g.textContent=n,i.append(u,m,g),l.append(i),l},s=(t,e)=>{const n=t.map((t=>r(t))),c=a("ul","benefit__list");return c.append(...n),c},l=async()=>{const t=((t,e)=>{const n=new URL(window.location.href);return e?[n.searchParams.get(t),n.searchParams.get(e)]:n.searchParams.get(t)})("category"),n=`/goods/category/${t}`,c=await e(n),o=a("h1","catalog__title");o.textContent=t;const r=s(c),l=document.querySelector(".catalog__container");l.innerHTML="",l.append(o,r)},i=document.querySelectorAll(".sublist_catalog");(()=>{const t=document.querySelectorAll(".nav__item_catalog .nav__title"),e=document.querySelectorAll(".nav__item_buyer .nav__title"),n=document.querySelectorAll(".sublist_catalog"),a=document.querySelectorAll(".sublist_buyer");t.forEach(((t,e)=>{t.addEventListener("click",(()=>{n[e].classList.toggle("sublist_show")}))})),e.forEach(((t,e)=>{t.addEventListener("click",(()=>{a[e].classList.toggle("sublist_show")}))}))})(),(()=>{const t=document.querySelector(".menu"),e=t.querySelector(".menu__img");t.addEventListener("click",(()=>{document.querySelector(".header-nav").classList.toggle("header-nav_active"),e.classList.toggle("menu__img-active")}))})(),(async()=>{const t=await e("/category"),n=document.querySelector(".header .sublist_catalog"),a=document.querySelector(".footer .sublist_catalog"),c=t.map((t=>o(t))),r=t.map((t=>o(t)));n.append(...c),a.append(...r)})(),i.forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault();const e=t.target;if(e.closest(".sublist__link")){const t=e.textContent;location.href=`catalog.html?category=${t}`,l()}}))})),l(),(t=>{const e=n(),a=document.querySelector(".btn-cart__count");e?(a.textContent=e,a.style.backgroundColor="#ffffff"):(a.textContent=e,a.style.backgroundColor="transparent"),t&&(document.querySelector(".cart__count").textContent=e,document.querySelector(".span__count").textContent=e)})()}();